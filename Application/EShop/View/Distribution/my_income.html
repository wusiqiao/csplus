<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style” content=black" />
    <title>我的收益</title>
    <link rel="stylesheet" href="{$Think.const.CSS_URL}mui/mui.css">
    <link href="/{$Think.MODULE_PATH}Public/popup/popup.css" rel="stylesheet" />
    <link href="{$Think.const.CSS_URL}reset.css" rel="stylesheet" />
    <link href="{$Think.const.CSS_URL}common.css" rel="stylesheet" />
    <link href="{$Think.const.CSS_URL}style.css" rel="stylesheet" />
    <script src="{$Think.const.JS_URL}jquery.min.js"></script>
    <script src="/{$Think.MODULE_PATH}Public/popup/popup.js"></script>
    <script src="{$Think.const.JS_URL}mui/mui.min.js"></script>
    <style type="text/css">
    	a {
    		color: inherit;
    	}
    	html,body {
    		background-color: #ffffff !important;
    	}
		.empty-background{
			height:320px;
			text-align: center;
			background-position: center center;
			background-size: 160px auto;
			background-repeat: no-repeat;
			background-image: url('/{$Think.MODULE_PATH}/Public/images/success.png')
		}
        .modals-content p{
            margin: 3px;
        }
    </style>
</head>
<body>
	<include file="Index:header" />
    <section class="my-inconme-wrap" >
    	<section class="inconme-wrap-top" style="height: 3.8rem;background-size: 100% 100%">
    		<div class="income-rules" id="income-rules">分销规则<span class="mui-icon mui-icon-arrowright"></span></div>
    		<div class="income-money">佣金<br><span>{$model.total_income}</span>元</div>
    		<div class="income-reward" style="border-bottom: none">
    			<div class="left">已解冻金额<br>{$model.commision_confirm}元</div>
    			<div>未解冻金额<br><span>{$model.commision_frozen}</span>元</div>
    		</div>

    		<!--<a href="javascript:;">
				<neq name="model.commision_can_withdrawal" value="0">
    					<div class="income-btn" id="income-btn">申请提现</div>
					<else/>
						 <div class="income-btn" style="color:#ccc">申请提现</div>
				</neq>
    		</a>-->
    	</section>
    	<section class="inconme-wrap-bottom">
    		<div class="income-tab" id="income-title">
    			<div class="active" style="width: 90%;">收益记录</div>
    			<!--<div class="">提现记录</div>-->
    		</div>
    		<ul id="income-con">
    			<li class="income-record">
					<empty name="model.incomes">
						<div class="empty-background"></div>
					</empty>
					<volist name="model.incomes" id="vo">
					<!--<div class="records">
    					<div>
	    					<div class="">{$vo.commision}</div>
	    					<div class="con-text-gray">{$vo.update_time|date="y-m-d H:i",###}</div>
	    				</div>
	    				<div>
	    					<div>{$vo.user_name}</div>
	    					<div class="con-text-gray">{$vo.memo}</div>
	    				</div>
	    				<div class="in-status">
	    					<span class="in-status-g">{$vo.status_view}</span>
	    				</div>
    				</div>-->
    				<div class="records">
						<div class="records-top">
							<div class="record-userinfo" style="width: 40%;">
		    					<!--<img src="https://eshop34.caisuikx.com//Application/ESAdmin/Upload/default_images/d41d8cd98f00b204e9800998ecf8427e/20180531/1527746831333976.png" alt="" />-->
		    					<img src="{$vo.head_pic}" alt="" style="width: 40%"/>
		    					<span style="width: 60%;overflow:hidden;text-overflow: ellipsis">{$vo.member_name}</span>
		    				</div>
		    				<div class="record-income">
		    					<span>{$vo.commision}</span>
		    				</div>
		    				<div class="in-status">
		    					<span class="in-status-b">{$vo.status_view}</span>
		    				</div>
						</div>
    					<div class="records-bottom">
    						<div class="basecolor">
    							<span>{$vo.memo}</span>
    							<!--<span>3600.00</span>-->
    						</div>
    						<div class="gray-c">{$vo.update_time|date="y-m-d H:i",###}</div>
    					</div>
    				</div>
					</volist>
					
    			</li>
    			<li class="withdraw-record" style="display: none;">
					<empty name="model.withdrawals">
						<div class="empty-background"></div>
					</empty>
					<volist name="model.withdrawals" id="vo">
    				<!--<div class="records">
    					<div>
	    					<div>{$vo.money}</div>
	    					<div class="con-text-gray">{$vo.time_view|date="y-m-d H:i",###}</div>
	    				</div>
	    				<div class="withdraw-status">
	    					<div class="withdraw-on"></div>
	    					<div class="con-text-black">{$vo.status_view}</div>
	    				</div>
    				</div>-->
    				
    				<div class="records">
    					<div>
	    					<div class="black-4">{$vo.money}</div>
	    					<div class="con-text-gray">{$vo.time_view|date="y-m-d H:i",###}</div>
	    				</div>
	    				<div class="withdraw-status">
	    					<div class="withdraw-on"></div>
	    					<div class="con-text-black">{$vo.status_view}</div>
	    				</div>
    				</div>
					</volist>
    				
    			</li>
    		</ul>
    		</div>
    	</section>
    </section>

    <!--modal-->
    <section class="modals-wrap" id="modals-wrap-rule">
    	<div class="modals-income-rules" style="height: auto">
    		<div class="modals-title">分销规则</div>
	    	<div class="modals-content" style="height: auto">
	    		1. 如何邀请好友成为“我的下级”？<br>
                <p>&emsp;&emsp;分享首页或者单个商品详情页给好友，好友通过该页面首次完成关注（公众号）或注册（商城会员）就能成为“我的下级”。<br></p>
				2. 如何产生收益？<br>
                <p>&emsp;&emsp;你的下级在本商城成功购买相应的商品或服务，你就可以获得固定比例或金额的交易佣金。<br></p>
				3. 如何提现？<br>
                <p>&emsp;&emsp;交易完成后交易佣金处于冻结期不可提现，需等待商家解冻后才能提现。交易过程中若出现项目分期，交易佣金可能会出现分批解冻的情况。<br></p>
				4. 提现申请后佣金何时到账？<br>
                <P>&emsp;&emsp;提现需经过商家审核，审核成功后商家会主动联系你手动结算佣金。</p>
	    	</div>
	    	<div class="modals-foot" id="close-rule">确定</div>
    	</div>

    </section>

    <section class="modals-wrap" id="modals-wrap-withdraw">
    	<div class="modals-income-withdraw">
    		<form action="">
    			<div class="modals-content" style="padding-top: .25rem;box-shadow: 0px 1px 0 #e4e4e4;">
	    			<div class="modal-input-lines">
	    				<label>可提现金额</label>
	    				<input type="text" disabled="disabled" name='commision_can_withdrawal' value="{$model.commision_can_withdrawal}"/>
						<span style="padding: .15rem;">元</span>
	    			</div>
	    			<div class="modal-input-lines">
	    				<label>输入提现金额</label>
	    				<input type="text" name='withdrawals_amount' />
	    			</div>
		    	</div>
		    	<div class="modals-foot confirm-cancellation">
		    		<button type="button"  class="certain">确定</button>
		    		<button type="button" onclick="$(this).parents('.modals-wrap').hide();">取消</button>
		    	</div>
    		</form>
    	</div>
    </section>

    <!--modal end-->
	<script src="/{$Think.APP_PATH}/Public/js/layer/mobile/layer.js"></script>
	<script>
		$(".modals-income-withdraw .certain").click(function(event){
		    var withdrawal_amount = $("input[name=withdrawals_amount]").val();
            var can_withdrawal_amount = $("input[name=commision_can_withdrawal]").val();
            if (isNaN(withdrawal_amount)){
                layer.open({content: '提现金额格式不正确！', btn:'确定'});
                return false;
			}
            if(withdrawal_amount < 0.01){
                layer.open({content: '提现金额不能少于0.01！', btn:'确定'});
                return false;
            }
		    if (parseFloat(withdrawal_amount) > parseFloat(can_withdrawal_amount)){
                layer.open({content: '金额不能超过可提现金额！', btn:'确定'});
                return false;
			}else{
                $.post("/Distribution/withdraw",{withdrawal_amount: withdrawal_amount}, function(result){
                    layer.open({content: result.message, skin: 'msg' ,time: 2});
                    setTimeout("location.href = '/Distribution/myIncome/random/{$model.commision_can_withdrawal}'", 2000);
				},"json");
			}
		});
		$('#income-title div').click(function() {
            var i = $(this).index();
            $(this).addClass('active').siblings().removeClass('active');
            $('#income-con li').eq(i).show().siblings().hide();
        });

        $('#income-rules').click(function(){
        	$('#modals-wrap-rule').show();
        })
        $('#close-rule').click(function(){
        	$(this).parents('#modals-wrap-rule').hide();
        })

		 $('#income-btn').click(function(){
			$('#modals-wrap-withdraw').show();
		 })
	</script>
</body>

</html>
